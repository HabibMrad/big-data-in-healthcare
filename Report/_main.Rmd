---
title: "Breast Cancer Report"
author:
- "Alessandro De Cicco MATRICOLA"
- "Emanuele Carnati MATRICOLA"
- "Lorenzo Mammana MATRICOLA"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
bibliography: bibliography.bib
biblio-style: apalike
link-citations: yes
description: "Final project"
output: 
  bookdown::pdf_book:
    includes:
      in_header: preamble.tex
    keep_tex: yes
subparagraph: yes
---
---
title: "Breast Cancer Report"
author:
- "Alessandro De Cicco MATRICOLA"
- "Emanuele Carnati MATRICOLA"
- "Lorenzo Mammana MATRICOLA"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
bibliography: bibliography.bib
biblio-style: apalike
link-citations: yes
description: "Final project"
output: 
  bookdown::pdf_book:
    includes:
      in_header: preamble.tex
    keep_tex: yes
subparagraph: yes
---

<!--chapter:end:index.Rmd-->


# Capitolo 1

Placeholder


## Breve introduzione discorsiva allo studio

<!--chapter:end:01-intro.Rmd-->

# Capitolo 2
## Statistiche descrittive
### Operazioni preliminari

Il package pander viene utilizzato per renderizzare in maniera elegante i metodi standard di R.
```{r warning=FALSE}
# carico le librerie necessarie
library("pander")
library("psych")
```

Carichiamo il dataset.
```{r}
dataset <-
  read.table(
    "../dataset.csv",
    na.strings = ".",
    sep = "\t",
    header = T,
    row.names = NULL
  )
```

Mostriamo le statistiche relative alle covariate cliniche, per le analisi su tutte le variabili ci riportiamo all' [Inserire link all'appendice]
```{r}
# Rimuovo l'id della riga
dataset <- dataset[,-1]

# Prendo solo le covariate cliniche
dataset <- dataset[1:7]

# Converto le variabili categoriche in categorie numeriche
dataset$Diam <- ifelse(dataset$Diam == "<=2cm", 0, 1)
dataset$N <- ifelse(dataset$N == "<4", 0, 1)
dataset$ER <- ifelse(dataset$ER == "Negative", 0, 1)
dataset$Grade <- ifelse(dataset$Grade == "Poorly diff",
                        0,
                        ifelse(dataset$Grade == "Intermediate", 1, 2))

VAR_NUMERIC <- c("time", "event", "Diam", "N", "ER", "Grade", "Age")
```

### Computazione statistiche

```{r}
pander(describe(dataset), big.mark = ",") #-- statistiche descrittive
```
Dalle statistiche vediamo che il tempo massimo di follow-up è di quasi 18 mesi e abbiamo più censure che eventi (media < 0.5). La media d'eta dei pazienti del nostro dataset e' di 44 anni, da un minimo di 26 anni ad un massimo di 53. Notiamo come il 33% dei pazienti sia deceduto al termine della terapia (mean-event).

\newpage

```{r}
pander(cor(dataset[,VAR_NUMERIC]),big.mark=",") #-- matrice di correlazione
```
Da una prima matrice di correlazione, tra le variabili principali dello studio, notiamo come solamente la variabile event abbia una correlazione di poco superiore a 0,5. 

\newpage

```{r}
par(mfrow = c(2, 4))
for (i in names(dataset))
{
  boxplot(dataset[, i],
          main = i,
          col = "lightblue",
          ylab = i)
}
```

Focalizzandosi sulle distribuzioni delle variabili "time" ed "Age" nei grafici dei boxplot:
  - la distribuzione tra il quartile superiore ed il quartile inferiore della variabile "time" ci indica che il 50% dei pazienti hanno avuto un trattamento di una durata tra i 6 ed i 10 mesi. Non sono presenti outlier.
  - la distribuzione tra il quartile superiore ed il quartile inferiore della variabile "Age" ci indica che l'età del 50% dei pazienti, al momento della diagnosi, si aggirava attori i 42 ed i 48 anni. è presente un solo outlier, il valore minimo riscontrato nella distribuzione (26 anni), un'eccezione rispetto all'età dei pazienti restanti che si aggira tra i 29 ed i 53 anni.

<!--chapter:end:02-descriptive-statistics.Rmd-->


# Capitolo 3

Placeholder


## Analisi univariate dell’associazione di ciascun fattore con l’outcome in studio

<!--chapter:end:03-univariate-analysis.Rmd-->


# Sviluppo del modello di rischio con covariate cliniche al basale

Placeholder


## Test non parametrici
## Modello di Cox al basale
## Modello baseline
## Valutazione dell'azzardo proporzionale
## Valutazione della forma funzionale delle variabili continue

<!--chapter:end:04-basal-model.Rmd-->


# Valutazione della performance del modello

Placeholder


## Calibrazione
### Predictiveness curve
### Brier score
## Discriminazione
## Net benefit

<!--chapter:end:05-performance.Rmd-->


# Regressione penalizzata su set di variabili di espressione genica

Placeholder


## Kaplan-Meier
## Valutiamo la correlazione tra le covariate geniche
## Valutazione della correlazione tra le covariate geniche e l'outcome
### Valutazione degli errori
## Regressione penalizzata
### Penalizzazione ridge
### Penalizzazione Lasso
## Lambda ottimale per la penalizzazione Lasso
## Penalizzazione Elastic Net
## Adaptive Lasso
## Comparazione dei modelli

<!--chapter:end:06-penalized-regression.Rmd-->


# Modello di Cox con covariate geniche

Placeholder


## Operazioni preliminari
## Modello di Cox
## Modello baseline
## Valutazione dell'azzardo proporzionale

<!--chapter:end:07-final-model.Rmd-->

# Capitolo 8
## Predizione del rischio di evento per 3 soggetti «tipo»

<!--chapter:end:08-test-prediction.Rmd-->

# Capitolo 9
## Breve commento discorsivo ai risultati. Menzionare eventuali limiti dei dati e problematiche riscontrate durante analisi










<!--chapter:end:09-conclusions.Rmd-->

# Bibliografia
<div id="refs"></div>

<!--chapter:end:10-bibliography.Rmd-->

# (APPENDIX) Appendix {-} 

# Appendice

## Analisi dei residui di Schoenfeld
```{r}
test.ph = cox.zph(model)
ggcoxzph(test.ph[1:9], font.main = 8, font.y = 7, font.x = 11, font.tickslab = 8)
ggcoxzph(test.ph[10:18], font.main = 8, font.y = 7, font.x = 11, font.tickslab = 8)
ggcoxzph(test.ph[19:27], font.main = 8, font.y = 7, font.x = 11, font.tickslab = 8)
ggcoxzph(test.ph[28:34], font.main = 8, font.y = 7, font.x = 11, font.tickslab = 8)
```

```{r}
# Verifica dei residui con il metodo di Lin
library("goftte")
prop(model, seed = 200519)
```

<!--chapter:end:11-Appendix.Rmd-->

